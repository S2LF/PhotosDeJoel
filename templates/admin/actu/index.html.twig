{% extends 'base.html.twig' %}

{% block title %}Les Photos de Joël | Créer catégorie{% endblock %}

{% block body %}

{% include "admin/adminNav.html.twig" %}


<h1>Espace Admin</h1>
<h2>Gestion des actualités</h2>

{% if actus|length == 0 %}
    <p>Aucune actualité</p>
{% else %}
    <section class="draggable">
        {% for actu in actus %}
            <article data-id="{{ actu.id }}" >
                <p>{{actu.categorie}} - {{actu.dateCreation|date('d/m/Y') }} <a href="{{ path('admin_actu_edit', {'id':actu.id})}}"><i class="fas fa-pen-square"></i></a></p>
                <p>{{ actu.contenu }}</p>
            </article>
        {% endfor %}
    </section>    
{% endif %}

<a href="{{ path('admin_actu_add') }}">Ajouter une actualité</a>
{% endblock %}

{% block javascripts %}
{{ parent() }}

<script>
  jQuery('.draggable').sortable({
    stop:function(event, ui){
      let id = ui.item.attr('data-id')
      console.log("id:"+id)
      let position = ui.item.index()
      console.log("pos:"+position)
      $.post(
        "{{ path('admin_actu_sort') }}",
        {
          'actu_id': id,
          'position': position
        },
        function(data){
          console.log(data)
        }
      )

    }
    



  })
</script>

{% endblock %}